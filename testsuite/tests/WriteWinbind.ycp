{

// test for Samba::WriteWinbind() write Winbind configuration
// $Id$

    include "testsuite.ycp";
    
    import "Samba";

    // disable winbind, but it was not enabled
    TEST( ``(Samba::WriteWinbind( false )), [
	// read map
	$[ 
	    "etc": $[ "nsswitch_conf" : $[
		"passwd" : "compat ldap", 
		"group"  : "compat ldap"
	    ] ]
	]
    ], nil );

    // disable winbind
    TEST( ``(Samba::WriteWinbind( false )), [
	// read map
	$[ 
	    "etc": $[ "nsswitch_conf" : $[
		"passwd" : "compat ldap winbind", 
		"group"  : "compat ldap winbind"
	    ] ]
	]
    ], nil );

    // enable winbind    
    TEST( ``(Samba::WriteWinbind( true )) , [
	// read map
	$[ 
	    "etc": $[ "nsswitch_conf" : $[
		"passwd" : "compat ldap", 
		"group"  : "compat ldap"
	    ] ]
	]
    ], nil );

    // enable winbind with non-default smb.conf
    Samba::winbind_uid = "30000-39999";
    Samba::winbind_gid = "30000-39999";
    TEST( ``(Samba::WriteWinbind( true )) , [
	// read map
	$[ 
	    "etc": $[ "nsswitch_conf" : $[
		"passwd" : "compat ldap", 
		"group"  : "compat ldap"
	    ] ]
	]
    ], nil );

}
